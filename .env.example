# Variables de entorno para configuración del chatbot
# Copiar este archivo a .env y configurar con tus valores

# ========================================
# MODELOS Y AI
# ========================================
MODEL_NAME="Sreenington/Phi-3-mini-4k-instruct-AWQ"
MODEL_DIR="/models/Sreenington--Phi-3-mini-4k-instruct-AWQ"
EMBEDDING_MODEL_DIR="/models/Qwen--Qwen3-Embedding-0.6B"

# ========================================
# SERVICIOS INTERNOS
# ========================================
VLLM_URL="http://vllm-openai:8000"
VLLM_EMBEDDING_URL="http://vllm-openai-embeddings:8001"

# ========================================
# STORAGE
# ========================================
BASE_CHROMA_PATH="chroma"
BASE_LOG_DIR="logs"
BASE_DATA_PATH="data"
BASE_TEMPLATES_DIR="templates"

# ========================================
# API KEYS
# ========================================
# Requerido para descargar modelos de Hugging Face
HF_TOKEN="your_huggingface_token_here"

# Opcional - para usar Gemini API
GEMINI_API_KEY="your_gemini_api_key_here"

# ========================================
# LTI / MOODLE INTEGRATION (Opcional)
# ========================================
# Solo necesario si integras con Moodle via LTI 1.3

# URL de tu instancia Moodle (sin trailing slash)
MOODLE_ISSUER="https://your-moodle.example.com"

# URL del endpoint de autenticación OIDC de Moodle
MOODLE_AUTH_LOGIN_URL="https://your-moodle.example.com/mod/lti/auth.php"

# URL del endpoint JWKS de Moodle para validación de tokens
MOODLE_JWKS_URL="https://your-moodle.example.com/mod/lti/certs.php"

# Client ID generado por Moodle al registrar la herramienta externa
MOODLE_CLIENT_ID="your_client_id_from_moodle"

# URL base del chatbot (debe ser HTTPS en producción)
# Usar Cloudflare Tunnel, Let's Encrypt, o servicio con SSL
CHATBOT_BASE_URL="https://your-chatbot-domain.example.com"

# URL del frontend (normalmente igual que CHATBOT_BASE_URL)
FRONTEND_URL="https://your-chatbot-domain.example.com"

# Directorio con configuración LTI (claves RSA)
LTI_CONFIG_DIR="./lti_config"

# ========================================
# MONGODB (User Service)
# ========================================
# URL de conexión a MongoDB para gestión de usuarios
USER_SERVICE_URL="http://user-service:8083"
MONGO_URI="mongodb://mongodb:27017"
MONGO_DB_NAME="chatbot_users"

# ========================================
# RATE LIMITING
# ========================================
# Límite de requests por usuario por minuto
RATE_LIMIT_PER_MINUTE=20

# ========================================
# DEVELOPMENT
# ========================================
# Modo debug (true/false)
DEBUG=false

# Log level (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL=INFO

# ========================================
# NOTES
# ========================================
# - Para desarrollo local sin LTI, solo necesitas HF_TOKEN
# - Para integración con Moodle, configura toda la sección LTI
# - CHATBOT_BASE_URL debe ser HTTPS si usas Moodle (requerimiento LTI 1.3)
# - Genera HF_TOKEN en https://huggingface.co/settings/tokens

# ========================================
# LANGFUSE CONFIGURATION
# ========================================
# Langfuse es un servicio de observabilidad para LLMs
# Genera valores seguros usando:
#   openssl rand -hex 32    (para ENCRYPTION_KEY)
#   openssl rand -hex 16    (para SALT)
#   openssl rand -base64 24 (para passwords)

# Langfuse Application URLs
NEXTAUTH_URL=http://localhost:3000

# Langfuse Database Configuration
DATABASE_URL=postgresql://postgres:CHANGE_ME_secure_password@postgres:5432/postgres
POSTGRES_USER=postgres
POSTGRES_PASSWORD=CHANGE_ME_secure_password
POSTGRES_DB=postgres
POSTGRES_VERSION=17

# Langfuse Security Keys (MUST CHANGE THESE!)
SALT=CHANGE_ME_generate_with_openssl_rand_hex_16
ENCRYPTION_KEY=CHANGE_ME_generate_with_openssl_rand_hex_32
NEXTAUTH_SECRET=CHANGE_ME_generate_with_openssl_rand_base64_24

# ClickHouse Configuration
CLICKHOUSE_MIGRATION_URL=clickhouse://clickhouse:9000
CLICKHOUSE_URL=http://clickhouse:8123
CLICKHOUSE_USER=clickhouse
CLICKHOUSE_PASSWORD=CHANGE_ME_clickhouse_password
CLICKHOUSE_CLUSTER_ENABLED=false

# MinIO Configuration (S3-compatible storage)
MINIO_ROOT_USER=minio
MINIO_ROOT_PASSWORD=CHANGE_ME_minio_password

# S3 Event Upload Configuration
LANGFUSE_S3_EVENT_UPLOAD_BUCKET=langfuse
LANGFUSE_S3_EVENT_UPLOAD_REGION=auto
LANGFUSE_S3_EVENT_UPLOAD_ACCESS_KEY_ID=minio
LANGFUSE_S3_EVENT_UPLOAD_SECRET_ACCESS_KEY=CHANGE_ME_minio_password
LANGFUSE_S3_EVENT_UPLOAD_ENDPOINT=http://minio:9000
LANGFUSE_S3_EVENT_UPLOAD_FORCE_PATH_STYLE=true
LANGFUSE_S3_EVENT_UPLOAD_PREFIX=events/

# S3 Media Upload Configuration
LANGFUSE_S3_MEDIA_UPLOAD_BUCKET=langfuse
LANGFUSE_S3_MEDIA_UPLOAD_REGION=auto
LANGFUSE_S3_MEDIA_UPLOAD_ACCESS_KEY_ID=minio
LANGFUSE_S3_MEDIA_UPLOAD_SECRET_ACCESS_KEY=CHANGE_ME_minio_password
LANGFUSE_S3_MEDIA_UPLOAD_ENDPOINT=http://localhost:9090
LANGFUSE_S3_MEDIA_UPLOAD_FORCE_PATH_STYLE=true
LANGFUSE_S3_MEDIA_UPLOAD_PREFIX=media/

# S3 Batch Export Configuration
LANGFUSE_S3_BATCH_EXPORT_ENABLED=false
LANGFUSE_S3_BATCH_EXPORT_BUCKET=langfuse
LANGFUSE_S3_BATCH_EXPORT_PREFIX=exports/
LANGFUSE_S3_BATCH_EXPORT_REGION=auto
LANGFUSE_S3_BATCH_EXPORT_ENDPOINT=http://minio:9000
LANGFUSE_S3_BATCH_EXPORT_EXTERNAL_ENDPOINT=http://localhost:9090
LANGFUSE_S3_BATCH_EXPORT_ACCESS_KEY_ID=minio
LANGFUSE_S3_BATCH_EXPORT_SECRET_ACCESS_KEY=CHANGE_ME_minio_password
LANGFUSE_S3_BATCH_EXPORT_FORCE_PATH_STYLE=true

# Redis Configuration (for Langfuse caching/queuing)
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_AUTH=CHANGE_ME_redis_password
REDIS_TLS_ENABLED=false

# Langfuse Features
TELEMETRY_ENABLED=true
LANGFUSE_ENABLE_EXPERIMENTAL_FEATURES=true
LANGFUSE_USE_AZURE_BLOB=false
